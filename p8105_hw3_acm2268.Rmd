---
title: "p8105_hw3_acm2268"
author: "Amanda Miles"
date: "10/16/2021"
output: github_document
---

```{r setup, include=FALSE}
knitr::opts_chunk$set(echo = TRUE)

library(tidyverse)
library(dplyr)

knitr::opts_chunk$set(
  fig.width = 6,
  fig.asp = .6,
  out.width = "90%"
)

theme_set(theme_minimal() + theme(legend.position = "bottom"))

options(
  ggplot2.continuous.colour = "viridis",
  ggplot2.continuous.fill = "viridis"
)

scale_colour_discrete = scale_color_viridis_d
scale_fill_discrete = scale_fill_viridis_d

```

#Question 1

##Reading in data

```{r p1_reading_in_data}

library(p8105.datasets)
data("instacart")

```

##Initial Data Exploration

```{r p1_understanding_data}

skimr::skim(instacart)

str(instacart)

```

This dataset is the Instacart Online Grocery Shopping Dataset from 2017 and the file is loaded from p8105.datasets. There are `r nrow(instacart)` rows of data and `r ncol(instacart)` variables in the dataset. The specific variables included are `r names(instacart)`.

There are `r max(instacart$aisle_id)` aisles and the most items are ordered from aisles `r  names(sort(table(instacart$aisle_id), decreasing = TRUE)[1:3])`.

##Plotting the number of items ordered per aisle among aisles with > 10,000 items ordered

```{r p1_plot_n_items_ordered}

n_items_df = instacart %>% 
  group_by(aisle, department) %>%
  summarise(n = n())

filter(n_items_df, n > 10000) %>%
print()

ggplot(n_items_df, aes(x = aisle, y = n, color = department)) + 
  geom_point(alpha = .5) +
  facet_grid(. ~ department)

```

##Creating Table with the 3 Most Popular Items Ordered from the Baking Ingredients, Dog Food Care, and Packaged Vegetables Aisles

```{r p1_table_3_most_popular items}

instacart %>%
  filter(aisle %in% c("baking ingredients", "dog food care", "packaged vegetables fruits")) %>%
  select(aisle, product_name) %>%
  group_by(product_name) %>%
  mutate(
    n_ordered = n(),
    n_rank = min_rank(desc(n_ordered)))
```

##Table: Mean hour at which Pink Lady Apples and Coffee Ice Cream are ordered each day of the week

```{r p1_mean_hour_dow}

instacart %>% 
  mutate(
    order_dow = recode(order_dow, `0` = "Monday", `1` = "Tuesday", `2` = "Wednesday", `3` = "Thursday", `4` = "Friday", `5` = "Saturday", `6` = "Sunday")) %>%
  select(product_name, order_dow, order_hour_of_day) %>% 
  filter(product_name %in% c("Pink Lady Apples", "Coffee Ice Cream")) %>%
  group_by(product_name, order_dow) %>%
  summarize(
    mean_hour = mean(order_hour_of_day)) %>%
  pivot_wider(names_from = order_dow, values_from = mean_hour)
```

